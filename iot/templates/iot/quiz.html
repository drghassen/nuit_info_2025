<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EcoTrack • Quiz</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --primary:#4361ee; --success:#10b981; --warning:#f59e0b; --danger:#ef4444; --dark:#0f172a; --light:#f8fafc; --gray:#64748b; --glass:rgba(255,255,255,0.15); --border:rgba(255,255,255,0.2);}    
    body { font-family:'Inter',sans-serif; background:linear-gradient(135deg,#0f172a 0%,#1e293b 50%,#334155 100%); color:#e2e8f0; min-height:100vh; }
    .navbar-custom{ background:rgba(15,23,42,.7); backdrop-filter:blur(12px); border-bottom:1px solid var(--border); }
    .glass-card{ background:var(--glass); backdrop-filter:blur(16px); border:1px solid var(--border); border-radius:20px; box-shadow:0 8px 32px rgba(0,0,0,.3); }
    .quiz-card{ max-width:860px; margin:40px auto; padding:28px; }
    .option{ background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:14px; padding:14px 16px; cursor:pointer; transition:.2s; }
    .option:hover{ background:rgba(67,97,238,.18); transform:translateY(-1px); }
    .option.correct{ border-color: rgba(16,185,129,.7); background: rgba(16,185,129,.15); }
    .option.wrong{ border-color: rgba(239,68,68,.7); background: rgba(239,68,68,.12); }
    .progress{ height:10px; background:rgba(255,255,255,.08); }
    .progress-bar{ background:linear-gradient(135deg, var(--primary), var(--success)); }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-custom sticky-top">
    <div class="container-fluid px-4">
      <a class="navbar-brand fw-bold fs-4" href="{% url 'dashboard' %}"><i class="fas fa-leaf text-success me-2"></i>EcoTrack <span class="text-primary">IoT</span></a>
      <div class="d-flex align-items-center gap-3">
        <a href="{% url 'dashboard' %}" class="btn btn-outline-light btn-sm"><i class="fas fa-gauge-high me-1"></i> Dashboard</a>
      </div>
    </div>
  </nav>

  <div class="container px-3 px-md-4">
    <div class="glass-card quiz-card">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="mb-0"><i class="fas fa-circle-question me-2 text-primary"></i>Quiz Éco-Responsable</h3>
        <div class="badge bg-primary">Score: <span id="score">0</span></div>
      </div>
      <div class="progress mb-4">
        <div id="progressBar" class="progress-bar" style="width: 0%"></div>
      </div>
      <div id="quiz">
        <!-- Rempli par JS -->
      </div>
      <div class="d-flex justify-content-between mt-4">
        <button id="prevBtn" class="btn btn-outline-light btn-sm" disabled><i class="fas fa-arrow-left me-2"></i>Précédent</button>
        <button id="nextBtn" class="btn btn-primary btn-sm">Suivant<i class="fas fa-arrow-right ms-2"></i></button>
      </div>
    </div>
  </div>

  <script>
    // Jeu de questions (exemple) sur le thème éco/IoT
    const questions = [
      {
        q: "Quel indicateur reflète l'impact environnemental global d'un device ?",
        options: ["CPU %", "Score Éco", "Requêtes/min", "Cloud %"],
        answer: 1
      },
      {
        q: "Un score d'obsolescence élevé signifie ?",
        options: ["Matériel récent", "Longue durée de vie", "Risque d'outdated important", "Dépendance faible"],
        answer: 2
      },
      {
        q: "Quelle métrique traduit directement la consommation d'énergie ?",
        options: ["Watts", "CO₂ (g)", "RAM %", "CPU %"],
        answer: 0
      },
      {
        q: "Réduire la dépendance Cloud a pour effet probable ?",
        options: ["Augmenter CO₂", "Réduire latence", "Réduire empreinte et coûts", "Diminuer disponibilité"],
        answer: 2
      }
    ];

    let current = 0;
    let score = 0;
    const selected = new Array(questions.length).fill(null);

    function renderQuestion(){
      const q = questions[current];
      const root = document.getElementById('quiz');
      const pct = Math.round(((current) / questions.length) * 100);
      document.getElementById('progressBar').style.width = `${pct}%`;
      document.getElementById('prevBtn').disabled = current === 0;
      document.getElementById('nextBtn').textContent = current === questions.length - 1 ? 'Terminer' : 'Suivant';
      root.innerHTML = `
        <div class="mb-3 fs-5">${current+1}. ${q.q}</div>
        <div class="row g-3">
          ${q.options.map((opt,i)=>`
            <div class="col-12">
              <div class="option ${selected[current]!==null ? (i===q.answer?'correct': (i===selected[current]?'wrong':'')) : ''}" data-index="${i}">
                <span class="me-2">${String.fromCharCode(65+i)}.</span>${opt}
              </div>
            </div>`).join('')}
        </div>`;
      root.querySelectorAll('.option').forEach(el=>{
        el.addEventListener('click', ()=>{
          if(selected[current]!==null) return; // déjà répondu
          const idx = Number(el.dataset.index);
          selected[current] = idx;
          if(idx === questions[current].answer) score++;
          document.getElementById('score').textContent = score;
          renderQuestion();
        });
      });
    }

    document.getElementById('prevBtn').addEventListener('click', ()=>{ if(current>0){ current--; renderQuestion(); }});
    document.getElementById('nextBtn').addEventListener('click', ()=>{
      if(current < questions.length-1){ current++; renderQuestion(); }
      else {
        document.getElementById('progressBar').style.width = '100%';
        const root = document.getElementById('quiz');
        root.innerHTML = `<div class='text-center py-4'>
          <h4 class='mb-3'><i class="fas fa-trophy text-warning me-2"></i>Résultat</h4>
          <p class='lead'>Score final: <strong>${score}/${questions.length}</strong></p>
          <a href='{% url "dashboard" %}' class='btn btn-success mt-3'><i class='fas fa-gauge-high me-2'></i>Retour au Dashboard</a>
        </div>`;
        document.getElementById('prevBtn').disabled = true;
        document.getElementById('nextBtn').disabled = true;
      }
    });

    renderQuestion();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
